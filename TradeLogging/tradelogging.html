<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClearEntry</title>
    <link rel="icon" type="image/png" href="../Home/clearentrylogo.png">
    <link href="tradelogging.css" rel="stylesheet" type="text/css">
    <link href="../newtradedetection.css" rel="stylesheet" type="text/css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/lucide@latest"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>
<body>

    <div id="settings-div" style="display: none;" class="MainFrame_Settings">
        <div id="mental-settings" style="display: none;" class="settings-div">
            <p class="inter-text entry-title"> 
                Manage Mental States
                <span class="dropdown-icon close-settingsbutton">
                    <i class="icon2 close-icon" data-lucide="x"></i>
                </span>
            </p>
            <p class="entry-description inter-text">
                Add or remove mental state options
            </p>
            <div>
                <input id="emotion-input" placeholder="Add new state..." class="settings-input">
                <span id="emotion-add">
                    <i class="settings-icon" data-lucide="plus"></i>
                </span>
            </div>
            <div id="mental-settings-dropdown" class="settings-list">
            </div>
        </div>
        <div id="strategy-settings" style="display: none;" class="settings-div">
            <p class="inter-text entry-title"> 
                Manage Strategies
                <span class="dropdown-icon close-settingsbutton">
                    <i class="icon2 close-icon" data-lucide="x"></i>
                </span>
            </p>
            <p class="entry-description inter-text">
                Add or remove strategy options
            </p>
            <div>
                <input id="strategy-input" placeholder="Add new strategy..." class="settings-input">
                <span id="strategy-add">
                    <i class="settings-icon" data-lucide="plus"></i>
                </span>
            </div>
            <div id="strategy-settings-dropdown" class="settings-list">
            </div>
        </div>
    </div>
    <div id="sidebar" class="SideBar">
        <a href="../Home/index.html" class="SideBar_Title inter-text">
            ClearEntry
        </a>
        <ul class="SideBar_List">
            <!-- Main Category -->
            <li class="SideBar_Category_Title inter-text">Main</li>
            <a class="anchor" href="../Dashboard/dashboard.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="layout-dashboard"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Dashboard
                    </p>
                </li>
            </a>
            <a class="anchor" href="../PreTrade/pretrade.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="check-circle"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Pre-Trade
                    </p>
                </li>
            </a>
            <a class="anchor" href="../TradeLogging/tradelogging.html">
                <li class="SideBar_List_ListItem selected-item">
                    <i class="SideBar_icon" data-lucide="pen-line"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Trade Logging
                    </p>
                </li>
            </a>
            <a class="anchor" href="../Entries/entires.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="list-ordered"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Entries
                    </p>
                </li>
            </a>
            
            <!-- Misc Category -->
            <li class="SideBar_Category_Title inter-text">Misc</li>
            <a class="anchor" href="../Analysis/analysis.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="chart-column"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Smart Analysis
                    </p>
                </li>
            </a>
            <a class="anchor" href="../Journal/journal.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="book-open"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Notes
                    </p>
                </li>
            </a>
            <a class="anchor" href="../Analytics/analytics.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="chart-no-axes-combined"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Analytics
                    </p>
                </li>
            </a>
            <a class="anchor" href="../UpdateLog/updatelog.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="scroll-text"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Update Log
                    </p>
                </li>
            </a>
            <a class="anchor" href="../Backtesting/backtest.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="play-circle"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Backtesting
                    </p>
                </li>
            </a>
            
            <!-- Account Category -->
            <li class="SideBar_Category_Title inter-text">Account</li>
            <a class="anchor" href="../Profile/profile.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="user"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Profile
                    </p>
                </li>
            </a>
            <a class="anchor" href="../Support/support.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="help-circle"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Support
                    </p>
                </li>
            </a>
            <a class="anchor" href="../Info/info.html">
                <li class="SideBar_List_ListItem">
                    <i class="SideBar_icon" data-lucide="info"></i>
                    <p class="SideBar_List_ListItem_Text inter-text">
                        Info
                    </p>
                </li>
            </a>
        </ul>
    </div>
    
    <div class="MainFrame">
        <div class="mainframe-loading">
            <div id="load-frame" class="loading-frame">
                <i class="spin-icon" data-lucide="loader"></i>
                <p class="load-text inter-text">
                    Loading Data
                </p>
            </div>
            
            <div id="loaded-frame" class="loading-frame">
                <i class="done-icon" data-lucide="circle-check"></i>
                <p class="load-text inter-text">
                    Data Loaded
                </p>
            </div>
        </div>
        <div id="head-frame" class="MainFrame_HeadFrame">
            <i id="bar-icon" data-lucide="text-align-justify"></i>
            <p class="MainFrame_Title inter-text">
                Trade Logging
            </p>
        </div>
        <p class="MainFrame_description inter-text">
            Log your trade details and track your performance
        </p>
        <div class="log_frames">
            <div class="log_frame">
                <p class="inter-text entry-title">
                    Trade Image Analyzer
                </p>
                <p class="entry-description inter-text">
                    Upload your trade screenshot. Our analyzer will read the image and automatically extract relevant trade data.
                </p>

                <label id="img_Input" for="tradeImageInput" class="img-frame">
                    <i class="upload-icon" data-lucide="upload"></i>
                    <p class="inter-text upload-img">Paste or click to upload</p>
                    <p class="inter-text upload-description">PNG, JPG up to 10MB</p>
                </label>
                <input type="file" check="" id="tradeImageInput" accept=".jpg,.jpeg,.png" hidden />
                <p id="img-analyze" class="inter-text">
                    Analyzing... (0%)
                </p>
                <img id="img_Frame" class="img-frame real-img" src="" alt="Trade Chart Preview" style="display: none;" />
            </div>
            <div class="log_frame">
                <p class="inter-text entry-title">
                    Trade Input Fields
                </p>
                <p class="entry-description inter-text">
                    Enter or verify your trade details below.
                </p>

                <!-- Link Pre-Trade Section -->
                <div style="margin-bottom: 20px; border-bottom: 1px solid rgba(128, 128, 128, 0.1);">
                    <p class="inter-text link-title">
                        Link Pre-Trade Session
                    </p>
                    <div class="flex-box link-flexdiv">
                        <div class="link-flexbox-div" style="flex: 1;">
                            <div id="pretrade-dropdown-button" class="dropdown-button inter-text">
                                <p id="pretrade-text" class="truncate text-div">Select a Pre-Trade</p>
                            <span class="dropdown-icon">
                                <i class="icon2" data-lucide="chevron-down"></i>
                            </span>
                        </div>
                            <div id="pretrade-dropdown" class="dropdown-div">
                            </div>
                        </div>
                        <div class="link-flexbox-button" style="flex: 0 0 auto; margin-left: 10px;">
                            <button id="unlink-pretrade-btn" class="inter-text">Clear</button>
                        </div>
                    </div>
                </div>

                <!-- Rule Compliance Badge (inside frame) -->
                <div id="rule-compliance-section">
                    <p class="inter-text entry-title2">
                        Rule Compliance Analysis
                    </p>
                    <div id="compliance-badge" class="inter-text" style="display: inline-block; padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 600; margin-bottom: 10px;">
                    </div>
                    <div id="compliance-reasons" class="inter-text" style="margin-top: 10px;">
                    </div>
                </div>

                <!-- Trade Type and Direction -->
                <div class="flex-box entry-flexdiv">
                    <div class="flexbox-div">
                        <p class="inter-text entry-title2">
                            Trade Type
                        </p>
                        <div id="type-dropdown-button" class="dropdown-button inter-text">
                            <p id="type-text" class="truncate text-div">Select Type</p>
                            <span class="dropdown-icon">
                                <i class="icon2" data-lucide="chevron-down"></i>
                            </span>
                        </div>
                        <div id="type-dropdown" class="dropdown-div">
                        </div>
                    </div>
                    <div class="flexbox-div">
                        <p class="inter-text entry-title2">
                            Direction                       
                        </p>
                        <div id="direction-dropdown-button" class="dropdown-button inter-text">
                            <p id="direction-text" class="truncate text-div">Select Direction</p>
                            <span class="dropdown-icon">
                                <i class="icon2" data-lucide="chevron-down"></i>
                            </span>
                        </div>
                        <div id="direction-dropdown" class="dropdown-div">
                        </div>
                    </div>
                </div>
                
                <div class="flex-box entry-flexdiv">
                    <div class="flexbox-div">
                        <p class="inter-text entry-title2">
                            Post Trade Mental State
                                                    
                            <span id="mental-settings-button" class="edit-icon">
                                <i class="icon" data-lucide="settings-2"></i>
                            </span>
                        </p>
                        <div id="state-dropdown-button" class="dropdown-button inter-text">
                            <p id="state-text" class="truncate text-div">State</p>
                            <span class="dropdown-icon">
                                <i class="icon2" data-lucide="chevron-down"></i>
                            </span>
                        </div>
                        <div id="mental-dropdown" class="dropdown-div">
                        </div>
                    </div>
                    <div class="flexbox-div">
                        <p class="inter-text entry-title2">
                            Strategy     

                        </p>
                        <div id="strategy-dropdown-button" class="dropdown-button inter-text">
                            <p id="strategy-text" class="truncate text-div">Select Strategy</p>
                            <span class="dropdown-icon">
                                <i class="icon2" data-lucide="chevron-down"></i>
                            </span>
                        </div>
                        <div id="strategy-dropdown" class="dropdown-div">
                        </div>
                    </div>
                </div>
                <p style="margin-top: 15px;" class="inter-text entry-title">
                    Entry Symbol
                </p>
                <input id="entry-SYMBOL" placeholder="EX: AAPL" class="inter-text entry-input">

                <div class="flex-box entry-flexdiv">
                    <div class="flexbox-div">
                        <p style="margin-top: 5px;" class="inter-text entry-title2">
                            Entry P/L
                        </p>
                        <input id="entry-PL" placeholder="EX: 120" class="inter-text entry-input2">
                            
                    </div>
                    <div class="flexbox-div">
                        <p style="margin-top: 5px;" class="inter-text entry-title2">
                            Risk to Reward
                        </p>
                        <input id="entry-RR" placeholder="EX: 1.2" class="inter-text entry-input2">
                    </div>

                </div>
                <div id="options-data">
                    <p style="margin-top: 5px; margin-bottom: 10px;" class="inter-text entry-title">
                        Options Data
                    </p>
                    <div class="flex-box entry-flexdiv">
                        <div class="flexbox-div">
                            <p style="margin-top: 5px;" class="inter-text entry-title2">
                                IV
                            </p>
                            <input id="entry-IV" placeholder="EX: 34.77" class="inter-text entry-input2">
                                
                        </div>
                        <div class="flexbox-div">
                            <p style="margin-top: 5px;" class="inter-text entry-title2">
                                Gamma
                            </p>
                            <input id="entry-Gamma" placeholder="EX: .0254" class="inter-text entry-input2">
                        </div>
                    </div>
                    <div class="flex-box entry-flexdiv">
                        <div class="flexbox-div">
                            <p style="margin-top: 5px;" class="inter-text entry-title2">
                                Delta
                            </p>
                            <input id="entry-Delta" placeholder="EX: .2499" class="inter-text entry-input2">
                                
                        </div>
                        <div class="flexbox-div">
                            <p style="margin-top: 5px;" class="inter-text entry-title2">
                                Theta
                            </p>
                            <input id="entry-Theta" placeholder="EX: -.0216" class="inter-text entry-input2">
                        </div>
                    </div>   
                    <div class="flex-box entry-flexdiv">
                        <div class="flexbox-div">
                            <p style="margin-top: 5px;" class="inter-text entry-title2">
                                Vega
                            </p>
                            <input id="entry-Vega" placeholder="EX: .1145" class="inter-text entry-input2">
                                
                        </div>
                        <div class="flexbox-div">
                            <p style="margin-top: 5px;" class="inter-text entry-title2">
                                Rho
                            </p>
                            <input id="entry-Rho" placeholder="EX: .0425" class="inter-text entry-input2">
                        </div>
                    </div>   
                </div>
                
                <p style="margin-top: 5px;" class="inter-text entry-title">
                    Entry Notes
                </p>
                <textarea id="entry-notes" placeholder="Describe your trade..." class="inter-text entry-textarea"></textarea>
                <div class="flex-box bottom-div">
                    <button id="continue-button" class="inter-text bottom-buttons green-button">Continue</button>
                    <button id="cancel-button" class="inter-text bottom-buttons"> Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <!-- Trade Ranking Modal -->
    <div id="trade-ranking-modal" class="trade-ranking-modal" style="display: none;">
        <div class="trade-ranking-modal-content">
            <p class="trade-ranking-title inter-text">Rank this trade</p>
            <div class="trade-ranking-options">
                <button class="trade-ranking-option" data-rank="Terrible">Terrible</button>
                <button class="trade-ranking-option" data-rank="Bad">Bad</button>
                <button class="trade-ranking-option" data-rank="Mediocre">Mediocre</button>
                <button class="trade-ranking-option" data-rank="Good">Good</button>
                <button class="trade-ranking-option" data-rank="Great">Great</button>
                <button class="trade-ranking-option" data-rank="Excellent">Excellent</button>
            </div>
            <button id="trade-ranking-save" class="trade-ranking-save-button inter-text">Save</button>
        </div>
    </div>

    <!-- AI Analysis Loading Modal -->
    <div id="ai-analysis-loading-modal" class="ai-analysis-loading-modal" style="display: none;">
        <div class="ai-analysis-loading-content">
            <div class="ai-loading-spinner">
                <i class="spin-icon-large" data-lucide="loader"></i>
            </div>
            <p class="ai-loading-title inter-text">Analyzing Your Trade</p>
            <p class="ai-loading-step inter-text" id="ai-loading-step">Reading trade data...</p>
            <div class="ai-loading-progress">
                <div class="ai-loading-progress-bar" id="ai-loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- AI Insights Display Modal -->
    <div id="ai-insights-modal" class="ai-insights-modal" style="display: none;">
        <div class="ai-insights-content">
            <div class="ai-insights-header">
                <i class="ai-insights-icon" data-lucide="brain"></i>
                <p class="ai-insights-title inter-text">Trade Insight</p>
            </div>
            <div class="ai-insights-body">
                <p class="ai-insights-text inter-text" id="ai-insights-text"></p>
            </div>
            <div class="ai-insights-footer">
                <button id="ai-insights-close" class="ai-insights-close-button inter-text green-button">Got it</button>
            </div>
        </div>
    </div>

    <!-- Post-Trade Reflection Modal -->
    <div id="post-trade-reflection-modal" class="post-trade-reflection-modal" style="display: none;">
        <div class="post-trade-reflection-content">
            <p class="reflection-title inter-text">Trade Reflection</p>
            <p class="reflection-subtitle inter-text">Help us understand your execution and mindset</p>
            
            <div class="reflection-form">
                <!-- Question 1: Strategy Adherence -->
                <div class="reflection-question">
                    <p class="reflection-question-text inter-text">Did you follow your strategy rules on this trade?</p>
                    <div class="reflection-options">
                        <button class="reflection-option" data-value="yes">Yes</button>
                        <button class="reflection-option" data-value="mostly">Mostly</button>
                        <button class="reflection-option" data-value="partially">Partially</button>
                        <button class="reflection-option" data-value="no">No</button>
                    </div>
                </div>

                <!-- Question 2: Entry Motivation -->
                <div class="reflection-question">
                    <p class="reflection-question-text inter-text">What was your primary reason for entering this trade?</p>
                    <div class="reflection-options">
                        <button class="reflection-option" data-value="setup-matched">Setup matched my criteria</button>
                        <button class="reflection-option" data-value="fomo">FOMO</button>
                        <button class="reflection-option" data-value="revenge">Revenge trading</button>
                        <button class="reflection-option" data-value="boredom">Boredom</button>
                        <button class="reflection-option" data-value="recover-losses">Trying to recover losses</button>
                        <button class="reflection-option" data-value="other-entry">Other</button>
                    </div>
                    <input type="text" id="entry-reason-other" class="reflection-text-input inter-text" placeholder="Describe" style="display: none; margin-top: 10px;">
                </div>

                <!-- Question 3: Re-take Decision -->
                <div class="reflection-question">
                    <p class="reflection-question-text inter-text">If you could take this trade again, would you?</p>
                    <div class="reflection-options">
                        <button class="reflection-option" data-value="definitely">Definitely</button>
                        <button class="reflection-option" data-value="probably">Probably</button>
                        <button class="reflection-option" data-value="unsure">Unsure</button>
                        <button class="reflection-option" data-value="probably-not">Probably not</button>
                        <button class="reflection-option" data-value="definitely-not">Definitely not</button>
                    </div>
                </div>

                <!-- Question 4: Emotional State -->
                <div class="reflection-question">
                    <p class="reflection-question-text inter-text">How do you feel after this trade?</p>
                    <select id="emotion-dropdown" class="reflection-dropdown inter-text">
                        <option value="">Select an emotion...</option>
                        <option value="relieved">Relieved</option>
                        <option value="disappointed">Disappointed</option>
                        <option value="vindicated">Vindicated</option>
                        <option value="regretful">Regretful</option>
                        <option value="confident">Confident</option>
                        <option value="frustrated">Frustrated</option>
                        <option value="neutral">Neutral</option>
                        <option value="other-emotion">Other</option>
                    </select>
                    <textarea id="emotion-description" class="reflection-textarea inter-text" placeholder="Describe how you're feeling" style="margin-top: 10px;"></textarea>
                </div>

                <!-- Question 5: What went well/poorly -->
                <div class="reflection-question">
                    <p class="reflection-question-text inter-text">What did you do well or poorly on this trade? (Optional)</p>
                    <textarea id="what-went-well-poorly" class="reflection-textarea inter-text" placeholder="Share your thoughts..."></textarea>
                </div>
            </div>

            <div class="reflection-buttons">
                <button id="reflection-save" class="reflection-save-button inter-text green-button">Submit</button>
                <button id="reflection-skip" class="reflection-skip-button inter-text">Skip</button>
            </div>
        </div>
    </div>

    <script src="../dataHandler.js"></script>
    <script src="tradelogging.js"></script>
    <script>

        lucide.createIcons();
    </script>
</body>
</html>